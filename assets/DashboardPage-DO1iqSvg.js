import{c as m,r as x,R as I,j as e,B as p,m as b,A as _}from"./index-BU3o7e8Q.js";import{A as h}from"./config-COe7nS04.js";import{M as T,F as j}from"./message-square-BtJnP0We.js";import{A as C,T as B}from"./trash-2-CIwAlc8e.js";const E=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],L=m("book",E);const R=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],y=m("brain",R);const P=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],F=m("clock",P);const D=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],U=m("pen-line",D);const q=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],H=m("upload",q),Y=({onChatOpen:w,activeCourseProp:v})=>{const[d,n]=x.useState([]),[l]=x.useState(v),[u,g]=x.useState(!1),[N,S]=x.useState(!0);I.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${h}/api/materials/${l.id}`)).json();n(r)}catch(s){console.error("Failed to fetch materials:",s)}finally{S(!1)}})()},[l.id]);const z=async t=>{const s=t.target.files;if(!s||s.length===0)return;const r=new FormData;r.append("course_id",l.id);const i=Array.from(s).map(a=>(r.append("files",a),{id:Math.random().toString(36).substr(2,9),name:a.name,type:a.type||"document",size:`${(a.size/(1024*1024)).toFixed(2)} MB`,status:"pending",progress:0,uploadedAt:new Date}));n(a=>[...a,...i]),n(a=>[...a,...i]);try{const a=localStorage.getItem("token");if(!(await fetch(`${h}/api/upload`,{method:"POST",headers:{Authorization:`Bearer ${a}`},body:r})).ok)throw new Error("Upload failed");i.forEach(c=>{$(c.id)})}catch(a){console.error("Upload Error:",a),n(o=>o.map(c=>i.find(A=>A.id===c.id)?{...c,status:"error",progress:0}:c))}},M=async()=>{g(!0);try{const t=localStorage.getItem("token");await fetch(`${h}/api/ingest/${l.id}`,{method:"POST",headers:{Authorization:`Bearer ${t}`}}),n(s=>s.map(r=>({...r,status:"processing",progress:80}))),setTimeout(()=>{n(s=>s.map(r=>({...r,status:"ready",progress:100}))),g(!1)},2e3)}catch{g(!1)}},[k,f]=x.useState(""),$=t=>{console.log(`Ingestion Tracking Started: ${t}`);const s=setInterval(async()=>{try{const i=await(await fetch(`${h}/api/ingest/status/${l.id}`)).json();i.status==="ready"||i.progress===100?(n(a=>a.map(o=>({...o,status:"ready",progress:100}))),f("System Ready. Multi-tenant workspace fully indexed."),clearInterval(s)):(n(a=>a.map(o=>o.status!=="ready"?{...o,status:"processing",progress:i.progress}:o)),f(`${i.status.toUpperCase()}: ${i.current_file}`))}catch(r){console.error("Polling Error:",r)}},800)};return e.jsxs("div",{className:"container mx-auto px-4 py-12 max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-8 mb-12",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-400 text-xs font-black uppercase tracking-widest rounded-full",children:"Teacher Dashboard"}),e.jsx("span",{className:"text-slate-300 dark:text-slate-700",children:"/"}),e.jsx("span",{className:"text-sm font-bold text-slate-500",children:l.subject})]}),e.jsxs("h1",{className:"text-5xl font-black text-slate-900 dark:text-white mb-2 tracking-tighter",children:["Manage ",e.jsx("span",{className:"text-blue-600",children:"Assistant"})]}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-medium text-lg",children:"Train your AI, manage documents, and monitor student engagement."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(p,{variant:"outline",size:"lg",className:"rounded-2xl border-dashed",onClick:()=>window.alert("Professional Workspace Customization is currently active. You can modify materials below or scrub the entire workspace in the System Panel."),children:e.jsx(U,{size:18})}),e.jsxs(p,{onClick:()=>w(l.id),size:"lg",className:"rounded-2xl gap-3 px-8 shadow-2xl shadow-blue-500/30",children:[e.jsx(T,{size:20}),"Launch AI Assistant"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-[2rem] border border-slate-200 dark:border-slate-800 shadow-sm transition-all hover:shadow-xl",children:[e.jsx(C,{className:"text-blue-600 mb-4",size:24}),e.jsx("div",{className:"text-3xl font-black text-slate-900 dark:text-white mb-1",children:l.studentCount}),e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Active Students"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-[2rem] border border-slate-200 dark:border-slate-800 shadow-sm transition-all hover:shadow-xl",children:[e.jsx(y,{className:"text-blue-400 mb-4",size:24}),e.jsx("div",{className:"text-3xl font-black text-slate-900 dark:text-white mb-1",children:"98%"}),e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"System Accuracy"})]})]}),e.jsxs("div",{className:"bg-slate-900 text-white p-8 rounded-[2.5rem] shadow-2xl shadow-blue-900/20 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-10 group-hover:opacity-20 transition-opacity",children:e.jsx(y,{size:120})}),e.jsx("h2",{className:"text-2xl font-black mb-4 relative z-10 leading-tight",children:"AI Training Status"}),e.jsxs("div",{className:"space-y-6 relative z-10",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold mb-2 uppercase tracking-wide opacity-60",children:[e.jsx("span",{children:"Knowledge Base"}),e.jsxs("span",{children:[d.filter(t=>t.status==="ready").length," Ready"]})]}),e.jsx("div",{className:"h-3 bg-white/10 rounded-full overflow-hidden",children:e.jsx(b.div,{initial:{width:0},animate:{width:d.length>0?d.filter(t=>t.status==="ready").length/d.length*100+"%":"0%"},className:"h-full bg-blue-500 shadow-[0_0_15px_rgba(59,130,246,0.5)]"})})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-white/5 rounded-2xl border border-white/10",children:[e.jsx(F,{size:16,className:"text-blue-400"}),e.jsxs("span",{className:"text-xs font-bold opacity-80",children:["Last trained: ",l.lastTrained?.toLocaleTimeString()]})]}),k&&e.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-2xl",children:[e.jsx("div",{className:"text-[10px] font-black text-blue-400 uppercase tracking-widest mb-1",children:"Indexing Status Log"}),e.jsx("div",{className:"text-xs font-mono text-white/90 truncate animate-pulse",children:k})]}),e.jsx(p,{onClick:M,disabled:u,className:`w-full ${u?"bg-slate-700":"bg-blue-600 hover:bg-blue-500"} text-white font-black py-4 rounded-2xl shadow-xl shadow-blue-600/30 transition-all`,children:u?"Updating Knowledge Base...":"Sync Knowledge Base"})]})]})]}),e.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-12 rounded-[3.5rem] border-4 border-dashed border-slate-200 dark:border-slate-800 hover:border-blue-500 dark:hover:border-blue-400 transition-all relative group cursor-pointer shadow-sm",children:[e.jsx("input",{title:"Upload file",type:"file",multiple:!0,onChange:z,className:"absolute inset-0 opacity-0 cursor-pointer z-10"}),e.jsxs("div",{className:"text-center relative z-0",children:[e.jsx("div",{className:"w-24 h-24 bg-blue-50 dark:bg-blue-900/30 rounded-[2.5rem] flex items-center justify-center text-blue-600 mx-auto mb-8 group-hover:scale-110 group-hover:rotate-6 transition-all duration-300 shadow-lg",children:e.jsx(H,{size:48})}),e.jsx("h3",{className:"text-3xl font-black mb-3 text-slate-900 dark:text-white tracking-tight",children:"Import Lecture Content"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-bold text-lg max-w-md mx-auto leading-relaxed",children:"Add your PDF slides, Word documents, or text files to train your assistant."})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-black text-2xl flex items-center gap-3 text-slate-900 dark:text-white",children:[e.jsx(L,{size:24,className:"text-blue-600"}),"Course Materials"]}),e.jsxs("span",{className:"text-xs font-black px-4 py-1.5 bg-slate-100 dark:bg-slate-800 rounded-full text-slate-400 uppercase tracking-widest border border-slate-200 dark:border-slate-700",children:["Total: ",d.length]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(_,{children:N?e.jsx("div",{className:"py-12 text-center text-slate-400 font-bold uppercase tracking-widest text-xs animate-pulse",children:"Scanning Secure Repository..."}):d.map(t=>e.jsxs(b.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,scale:.95},className:"bg-white dark:bg-slate-900 p-6 rounded-[2rem] border border-slate-200 dark:border-slate-800 flex items-center gap-6 group hover:border-blue-500/50 transition-all shadow-sm",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-50 dark:bg-slate-800 rounded-2xl flex items-center justify-center text-slate-400 group-hover:text-blue-600 transition-colors shadow-inner",children:e.jsx(j,{size:32})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"font-black text-lg text-slate-900 dark:text-white truncate",children:t.name}),e.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest px-2 py-0.5 rounded-md ${t.status==="ready"?"bg-green-100 text-green-600":"bg-blue-100 text-blue-600 animate-pulse"}`,children:t.status})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-grow h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx(b.div,{initial:{width:0},animate:{width:t.progress+"%"},className:`h-full ${t.status==="ready"?"bg-green-500":"bg-blue-600"}`})}),e.jsxs("span",{className:"text-xs font-black text-slate-400 w-10 text-right",children:[t.progress,"%"]})]})]}),e.jsx(p,{variant:"ghost",onClick:async()=>{try{const s=localStorage.getItem("token");await fetch(`${h}/api/materials/${l.id}/${t.name}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}}),n(d.filter(r=>r.id!==t.id))}catch(s){console.error("Delete failed:",s)}},className:"p-3 h-auto text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/10 rounded-2xl",children:e.jsx(B,{size:24})})]},t.id))}),d.length===0&&e.jsxs("div",{className:"text-center py-24 bg-white dark:bg-slate-900/50 rounded-[4rem] border-2 border-dashed border-slate-200 dark:border-slate-800 shadow-inner",children:[e.jsx("div",{className:"w-24 h-24 bg-slate-50 dark:bg-slate-800/50 rounded-full flex items-center justify-center mx-auto mb-8 text-slate-300 dark:text-slate-700 shadow-lg",children:e.jsx(j,{size:48})}),e.jsx("h4",{className:"text-2xl font-black text-slate-900 dark:text-white mb-2 tracking-tight",children:"Empty Repository"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-bold text-lg",children:"Start by uploading your academic materials above."})]})]})]})]})]})]})};export{Y as DashboardPage};
